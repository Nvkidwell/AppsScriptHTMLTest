function doGet() {
  return HtmlService.createHtmlOutputFromFile('Index')
    .setTitle('Book Library')
    .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
}

function getBooks() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = sheet.getDataRange().getValues();
  return data.slice(1); // Exclude header row
}

function addBook(title, author) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  sheet.appendRow([title, author]);
  return getBooks();
}
